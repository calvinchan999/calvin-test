<div class="title arcs" *ngIf = "locationTree" >
  <div class="location-tree">
    <a class="site-name" *ngIf = "locationTree?.site?.code"  (click)="to2D.emit({showSite : true })"> {{locationTree.site.name}} </a>  
    <span class="mdi mdi-chevron-right" *ngIf = "locationTree?.site?.code && locationTree.currentLevel == 'floorplan'"></span>
    <span class="building-name" *ngIf = "locationTree?.site?.code && locationTree.currentLevel == 'floorplan'"> {{locationTree.building.name}}</span>
  </div>
  <span class="floorplan" *ngIf = "locationTree?.currentLevel == 'floorplan' && floorPlanDataset"> 
    <uc-dropdown   [options]="floorPlanOptions"   [value] = "floorPlanDataset.floorPlanCode"  
                   [allowClear] = "false"  [customDropItemTemplate] = "true"
                   (valueChange)="parent? parent.loadFloorPlan($event) : null"
                   (open)="parent? parent.setFloorplanRobotCount(floorPlanOptions) : null ;" class = "arcs-floorplan-picker">
    </uc-dropdown>
  </span>
</div>

<div class="buttons-container t1">
  <button  *ngIf="uiToggles.showWaypoint !== undefined" kendoButton class="show-waypoint" [matTooltip]="((uiToggles.showWaypoint && uiToggles.showWaypointName) ? 'Hide Waypoint Name' : ((uiToggles.showWaypoint && !uiToggles.showWaypointName) ? 'Hide Waypoint' : 'Show Waypoint'))| label : uiSrv.langPack"  
                 matTooltipPosition="right" 
                (click)=" uiToggles.showWaypointName = !(uiToggles.showWaypoint && uiToggles.showWaypointName); uiToggles.showWaypoint = !(uiToggles.showWaypoint && uiToggles.showWaypointName) ; uiToggled('waypoint') ; uiToggled('waypointName') "  
                [ngClass]="{'btn-intermediate': uiToggles.showWaypoint && !uiToggles.showWaypointName , 'btn-active': uiToggles.showWaypoint && uiToggles.showWaypointName }">
          <span class="mdi mdi-map-marker"></span>
 </button>
  <button *ngIf="uiToggles.showWall !== undefined && floorplan?.settings?.walls" kendoButton class="wall" [matTooltip]="'Show walls' | label : uiSrv.langPack" (click)="uiToggles.showWall = !uiToggles.showWall ; uiToggled('wall')" [ngClass]="{'btn-active':uiToggles.showWall}" >
    <span class="mdi mdi-wall"></span>
  </button>
  <button *ngIf="uiToggles.to2D !== undefined" kendoButton class="2d-switch" [matTooltip]="'2D Map' | label : uiSrv.langPack" (click)="dataSrv.setLocalStorage('dashboardMapType' , '2D');to2D.emit({floorPlanCode : floorPlanDataset.floorPlanCode })">
    <span class="mdi mdi-video-2d"></span>
  </button>
  <button *ngIf="uiToggles.showIot !== undefined"  kendoButton class="robot-status-popup" [matTooltip]="'Show IoT Info' | label : uiSrv.langPack"  (click)="uiToggles.showIot = !uiToggles.showIot ; uiToggled('robotStatus')" [ngClass]="{'btn-active':uiToggles.showIot}" >
    <span class="mdi mdi-message-text"></span>
  </button>
  <button *ngIf="uiToggles.fullScreen !== undefined"  kendoButton class="full-screen" [matTooltip]="'Full Screen' | label : uiSrv.langPack" (click)="toggleFullScreen()"  [ngClass]="{'btn-active':fullScreen}" >
    <span [class]="'mdi mdi-' + (fullScreen ? 'fullscreen-exit' : 'fullscreen')"></span>
  </button>
  <button *ngIf="uiToggles.showFloorPlanImage !== undefined" kendoButton class="wall" [matTooltip]="'Show 2D Floor Plan' | label : uiSrv.langPack" (click)="uiToggles.showFloorPlanImage = !uiToggles.showFloorPlanImage ; uiToggled('showFloorPlanImage')" [ngClass]="{'btn-active':uiToggles.showFloorPlanImage}" >
    <span class="mdi mdi-floor-plan"></span>
  </button>
</div>
<div #canvas class="canvas-container"></div>

<div *ngIf="loadingPercent!=null" class="three-js-viewport-overlay" [style.width]="width + 'px'" [style.height]="height + 'px'">
  <div>
    <span>{{ "Loading 3D Model" | label : uiSrv.langPack }}</span>
    <kendo-progressbar [max]="100" [value]="loadingPercent" [label]='{visible: false, format: "percent", position: "center"}'>
    </kendo-progressbar>
  </div>
</div>

<!-- <th-canvas #canvas (onRender)="animate()" >
  <th-scene #scene>
    <th-ambientLight [intensity]="0.1" intensity_x="0.7"> </th-ambientLight>
    <th-pointLight [position]="[floorplan?.width / 2 ,  floorplan?.height  ,  floorplan?.height / 2]" [intensity]="0.1" intensity_x = "0.4" [decay]="10"> 
    </th-pointLight>
    <th-perspectiveCamera #camera [args]="[45, 1, 1 , 10000000]">
    </th-perspectiveCamera>
  </th-scene>
</th-canvas> -->